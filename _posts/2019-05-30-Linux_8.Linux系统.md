---
title: Linux_8.Linux系统
layout: post
categories: Linux
tags: Linux_8.Linux系统
---
## 八、Linux系统

### 1.设置主机名

主机ip：192.168.111.129

回顾：

>\#hostname

>\#hostname -f 	FQDN(全限定域名)

①临时设置主机名（立竿见影）

>\#hsotname 主机名

②永久设置主机名（需要重启）

>先找到一个文件 /etc/hostname

>按i 进入编辑模式，修改本机名为xuelei，修改后按esc退出

>:x 退出

③修改linux服务器的hosts文件，将xuelei指向本地

  在ip地址后面加入域名xuelei
  
  问题：不设置FQDN会怎么样？
  
>很多开源服务器软件（如Apache）则无法启动，或出现保存

>方便记忆，看主机名对其作用有一个初步的判断

>如果不设置则会影响本地域名的解析（本地访问）

### 2.chkconfig

（CentOS7 将service、chkconfig合为一体：systemctl）

https://www.cnblogs.com/devilmaycry812839668/p/8481760.html

作用：相当于windows下"安全卫士"、"电脑管家"之类的安全辅助工具提供“开机启动项”的一个管理服务。

在linux下不是所有的软件安装完成之后都有开机启动服务，有的可能需要自己去添加。还可以查看和删除、修改。

①开机启动服务查询

>\#chkconfig --list
	
②删除服务

>\#chkconfig --del 服务名
	
③添加开机启动服务

>\#chkconfig --add 服务名
	
④设置服务在某个级别下开机启动/不启动【重点命令】

>\#chkconfig --level 连在一起的启动级别 服务名 on/off

### 3.ntp服务

作用：ntp主要是用于对计算机的时间同步管理操作。

时间是对服务器来说是很重要的，一般很多网址站都需要读取服务器时间来记录相关信息，如果时间不准，可能造成很大的影响。

同步服务器时间方式有2个：一次性同步（手动同步、通过服务自动同步）

上游的感念：

自己的服务器→上一级服务器→上上一级服务器...

①一次性同步时间（简单）

>\#ntpdate 时间服务器的域名或ip地址

>地址查看网站：http://www.ntp.org.cn/pool.php

②设置时间同步服务

>服务名：ntpd

>启动ntpd服务：#service ntpd start 或者 /etc/init.d/ntpd start

>设置ntpd服务开机启动：

### 4.防火墙服务

防火墙：防范一些网络攻击。有软件防火墙、硬件防火墙之分。

防火墙选择让请求通过，从而保证网络安全性。

在当前的centos6.5中防火墙有一个名称：iptables【7.x中默认使用的是firewalld】

国家长城防火墙 GFW

①查看iptables是否开机启动

②iptables服务启动/重启/关闭

>\#service iptables stop/start/restart
	
③查看iptables的状态（规则）

>\#service iptables tatus

如果iptables没有启动，则提示服务没启动，如果已经启动，则显示防火墙的相关的规则信息

④查看规则的命令

>\#iptables -L -n
	
	含义：
	
		-L：表示列出规则
		
		-n：表示将单词表达形式改成数字形式显示
		
⑤简单设置防火墙规则

例如，需要运行80端口通过防火墙，则规则可以用以下的命令来设置

	#iptables -I INPUT -p tcp --dport 80 -j ACCEPT   //允许访问80端口
	
Iptables：主命令

-I：表示讲规则放到最前面

-A：add，添加规则放到最后面

INPUT：进站要求【出站 output】

-p：protocol，指定协议（icmp/tcp/udp）

--dport：指定端口号

-j：指定行为结果，允许（accept）/禁止（reject）

	添加完成后需要保存操作：
	
	/etc/init.d/iptables save

### 5.rpm软件管理（重点）

作用：rpm的作用类似于windows上的电脑管家中“软件管理”，主要作用是对linux服务器上的软件包进行对应管理操作，管理分为：查询、卸载、安装。

①查询某个软件的安装情况

	#rpm -qa|grep 关键词
	
	选项：
	
		-q：查询，query
		
		-a：全部，all

	案例：rpm -qa|grep firefox
	
②卸载某个软件

>\#rpm -e 软件的名称

当存在依赖关系的时候又不想去解决这个问题的时候可以：

>\#rpm -e 软件包名 --nodeps

③软件的安装

要想安装软件，和windows下一样，先得找到安装包。

	软件包的获得方式：
	
		a.去官网下载；
		
		b.不介意老版本的话，可以从光盘中读取；
		
此处以光盘文件为例：

	查看块状设备的信息：#lsblk	（list block devices）
	
	> Size：设备大小
	
	> MountPoint：挂载点（类似于windows下盘符）

扩展：光盘的挂载和解挂

	a.解挂操作
	
	命令：umount
	
	语法：#umount 当前设备的挂载点（路径）
	
        此时，相当于U盘在windows上已经被弹出饿了，但是没有拔下电脑USB接口

```
b.挂载光盘
命令：mount
语法L#mount 设备原始地址 要挂载的位置路径
  设备原始地址：地址统一都在/dev下，然后根据大小确定具体name值，拼凑在一起组成原始地址，例如当前："/dev/sr0"
  要挂载的位置路径：挂载目录一般都在mnt下，也可以在mnt下建目录，此处以“/mnt/dvd”为例
```

安装软件的命令：
>\#rpm -ivh 软件包完整名称

	选项：
	
		-i：install，安装
		
		-v：显示进度条
		
		-h：表示以“#”形式显示进度条

### 6.crom/crontab计划任务（重点）

作用：操作系统不能能24小时都有人在操作，有些时候想在指定的时间点去执行任务（例如，每天夜里2点去重新启动服务),此时可以交给计划任务程序去执行操作

	语法：#crontab 选项 
	
	常用选项：
	
		-l：list，列出指定用户的计划任务列表
		
		-e：edit，编辑指定用户的计划任务列表
		
		-u：user，指定的用户名，如果不指定，则表示当前用户
		
		-r：remove，删除指定用户的计划任务列表
		
	①列出
	
	②编辑计划任务（重点）
	
		计划任务的规则语法格式，以行位单位，一行则为一个计划：
		
		* 分 时 日 月 周 需要执行的命令		0 0 * * * reboot
		* 	
	例如：如果想要每天的0点0分执行reboot指令，则可以写成
	
	取值范围：
	
		> 分：0~59
		
		> 时：0~23
		
		> 日：1~31
		
		> 月：1~12
		
		> 周：0~6，0表示星期天
		
	四个符号：

		> * ：表示取值范围中的每一个数字
		
		> - ：做连续区间表达式的，要想表示1~7，则可以写成1-7
		
		> / ：表示每多少个，例如：想每10min一次，则可以在分的位置写： */10
		
		>  , ：表示多个取值，比如想在1点，2点，6点执行，则可以在时的位置写：1,2,6

```
问题一：每月1、10、22日的4:45重启network服务

	> 45 4 1,10,22 * * service network restart
	
问题二：每天18:00至23:00之间每隔30分钟重启network服务

	> */30 18-23 * * * service network restart
	
问题三：每隔两天的上午8点到11点的第3和第15分钟执行一次重启

	> 3,15  8-11  */2  *  *  reboot
	
案例：真是测试案例，每5秒钟向root家目录中的RT.txt中输入当前的时间信息，为了看到效果使用追加输出

	计划任务：*/1  *  *  *  *  ls ~>>/root/RT.txt
	
```

Crontab权限问题：本身是任何用户都可以创建自己的计划任务
但是超级管理员可以通过配置来设置某些用户不允许设置计划任务：
配置文件位于（黑名单）：
	/etc/cron.deny	里面写用户名，一行一个
还有一个配置文件（白名单）：
	/etc/cron.allow	本身不存在，需要自己创建
注意：白名单优先级高于黑名单，如果一个用户同时存在两个名单文件中，则会默认允许创建计划任务。